#DROP DATABASE DESAFIO_FORTES;
CREATE DATABASE DESAFIO_FORTES;
USE DESAFIO_FORTES;


#PRIMEIRO CRIAR AS TABELAS QUE NÃO TEM CHAVE ESTRANGEIRA, SEGUIR ESSA ORDEM DEVE DAR CERTO.
CREATE TABLE IF NOT EXISTS LOGIN(
ID_LOGIN INT PRIMARY KEY,
EMAIL VARCHAR(45) NOT NULL,
SENHA VARCHAR(45) NOT NULL
);


CREATE TABLE IF NOT EXISTS ENDERECOS(
ID_ENDERECOS INT PRIMARY KEY,
CEP VARCHAR(9) NOT NULL,
UF CHAR(2) NOT NULL,
CIDADE VARCHAR(45) NOT NULL,
RUA VARCHAR(45) NOT NULL,
NUM_RUA INT
);


CREATE TABLE IF NOT EXISTS FINANCEIRO(
ID_FINANCEIRO INT PRIMARY KEY,
ARQUIVO BLOB
);


CREATE TABLE IF NOT EXISTS FUNCIONARIOS(
ID_FUNCIONARIO INT PRIMARY KEY,
NOME VARCHAR(45) NOT NULL,
CPF VARCHAR(14) NOT NULL,
LOGIN_ID_FUNC INT NOT NULL,
CONSTRAINT FK_LOGIN_FUNC FOREIGN KEY(LOGIN_ID_FUNC) REFERENCES LOGIN(ID_LOGIN)
);


CREATE TABLE IF NOT EXISTS EMPRESAS(
ID_EMPRESAS INT PRIMARY KEY,
CNPJ VARCHAR(18) NOT NULL,
RAZAO_SOCIAL VARCHAR(45) NOT NULL,
NOME_FANTASIA VARCHAR(45),
TELEFONE VARCHAR(14) NOT NULL,
LOGIN_ID_EMPR INT NOT NULL,
ENDERECOS_ID_EMPR INT NOT NULL,
CONSTRAINT FK_LOGIN_EMPR FOREIGN KEY(LOGIN_ID_EMPR) REFERENCES LOGIN(ID_LOGIN),
CONSTRAINT FK_ENDERECOS_EMPR FOREIGN KEY(ENDERECOS_ID_EMPR) REFERENCES ENDERECOS(ID_ENDERECOS)
);


CREATE TABLE IF NOT EXISTS RECUPERAR_SENHA(
ID_RECUPERACAO INT PRIMARY KEY,
NOVA_SENHA VARCHAR(45) NOT NULL,
RS_DATA DATE NOT NULL,
RS_HORA TIME NOT NULL,
LOGIN_ID_RECUPERAR INT NOT NULL,
CONSTRAINT FK_LOGIN_RECUPERAR FOREIGN KEY(LOGIN_ID_RECUPERAR) REFERENCES LOGIN(ID_LOGIN)
);

CREATE TABLE IF NOT EXISTS USUARIOS(
ID_USUARIOS INT PRIMARY KEY,
CPF VARCHAR(14) NOT NULL,
NOME VARCHAR(45) NOT NULL,
TELEFONE VARCHAR(17),
LOGIN_ID_USUARIOS INT NOT NULL,
ENDERECOS_ID_USUARIOS INT NOT NULL,
CONSTRAINT FK_LOGIN_USUARIOS FOREIGN KEY(LOGIN_ID_USUARIOS) REFERENCES LOGIN(ID_LOGIN),
CONSTRAINT FK_ENDERECOS_USUARIOS FOREIGN KEY(ENDERECOS_ID_USUARIOS) REFERENCES ENDERECOS(ID_ENDERECOS)
);

CREATE TABLE IF NOT EXISTS FALE_CONOSCO(
ID_FC INT PRIMARY KEY,
RECLAMACAO TEXT NOT NULL,
DATA_RECLAMACAO DATE NOT NULL,
USUARIOS_ID_FC INT NOT NULL,
CONSTRAINT FK_USUARIOS_FC FOREIGN KEY(USUARIOS_ID_FC) REFERENCES USUARIOS(ID_USUARIOS)
);

CREATE TABLE IF NOT EXISTS PROJETOS(
ID_PROJETO INT PRIMARY KEY,
NOME_PROJETO VARCHAR(45) NOT NULL,
EMPRESAS_ID_PROJETO INT NOT NULL,
FINANCEIRO_ID_PROJETO INT NOT NULL,
CONSTRAINT FK_EMPRESAS_PROJETOS FOREIGN KEY(EMPRESAS_ID_PROJETO) REFERENCES EMPRESAS(ID_EMPRESAS),
CONSTRAINT FK_FINANCEIRO_PROJETOS FOREIGN KEY(FINANCEIRO_ID_PROJETO) REFERENCES FINANCEIRO(ID_FINANCEIRO)
);

CREATE TABLE IF NOT EXISTS HISTORICO_ACOMPANHAMENTO(
DATA_HISTORICO DATE NOT NULL,
PROJETOS_ID_HISTORICO INT NOT NULL,
STATUS_PROJETO ENUM('APROVADO', 'PENDENTE', 'REPROVADO') NOT NULL,
FUNCIONARIOS_ID_HA INT NOT NULL,
PRIMARY KEY(DATA_HISTORICO, PROJETOS_ID_HISTORICO),
CONSTRAINT FK_PROJETOS_HISTORICO FOREIGN KEY(PROJETOS_ID_HISTORICO) REFERENCES PROJETOS(ID_PROJETO),
CONSTRAINT FK_FUNCIONARIOS FOREIGN KEY(FUNCIONARIOS_ID_HA) REFERENCES FUNCIONARIOS(ID_FUNCIONARIO)
);


CREATE TABLE IF NOT EXISTS USUARIOS_PROJETOS(
PROJETOS_ID INT,
USUARIOS_ID INT,
PRIMARY KEY(PROJETOS_ID, USUARIOS_ID),
CONSTRAINT FK_USUARIO_PROJETO FOREIGN KEY(USUARIOS_ID) REFERENCES USUARIOS(ID_USUARIOS),
CONSTRAINT FK_PROJETO_USUARIO FOREIGN KEY(PROJETOS_ID) REFERENCES PROJETOS(ID_PROJETO)
);


INSERT INTO LOGIN(ID_LOGIN, EMAIL, SENHA) VALUES
(1, 'juliana@gmail.com', 'juliana123'),
(2, 'roberto@gmail.com', 'roberto123'),
(3, 'maria@gmail.com', 'maria123'),
(4, 'carla@gmail.com', 'carla123'),
(5, 'joão@gmail.com', 'joão123'),
(6, 'empresa01@gmail.com', 'empresa01123'),
(7, 'empresa02@gmail.com', 'empresa02123');


INSERT INTO ENDERECOS(ID_ENDERECOS, CEP, UF, CIDADE, RUA, NUM_RUA) VALUES
(1, '29900-001', 'ES', 'VITÓRIA', 'RUA MANGUEIRA', 1),
(2, '29900-002', 'ES', 'VITÓRIA', 'RUA LIMOEIRO', 2),
(3, '29900-003', 'ES', 'VITÓRIA', 'RUA CEREJEIRA', 3),
(4, '29900-004', 'ES', 'SERRA', 'AVENIDA PARDAL', 4),
(5, '29900-005', 'ES', 'SERRA', 'AVENIDA CANÁRIO', 5),
(6, '29900-006', 'ES', 'VITÓRIA', 'RUA LIMOEIRO', 6),
(7, '29900-007', 'ES', 'SERRA', 'AVENIDA DAS GARÇAS', 7);

INSERT INTO FINANCEIRO(ID_FINANCEIRO, ARQUIVO) VALUES
(1, NULL),
(2, NULL);

INSERT INTO FUNCIONARIOS(ID_FUNCIONARIO, NOME, CPF, LOGIN_ID_FUNC) VALUES
(1, 'JULIANA', '111.111.111-01', 1);


INSERT INTO EMPRESAS(ID_EMPRESAS, CNPJ, RAZAO_SOCIAL, NOME_FANTASIA, TELEFONE, LOGIN_ID_EMPR, ENDERECOS_ID_EMPR) VALUES
(1, '11.111.111/0001-11', 'EMPRESA01 ENGENHARIA E TECNOLOGIA LTDA', 'EMPRESA01', '(27)99999-1111', 6, 6),
(2, '22.222.222/0002-22', 'EMPRESA02 COMERCIO DE ALIMENTOS LTDA', 'EMPRESA02', '(27)99999-2222', 7, 7);


INSERT INTO RECUPERAR_SENHA(ID_RECUPERACAO, NOVA_SENHA, RS_DATA, RS_HORA, LOGIN_ID_RECUPERAR) VALUES
(1, 'bolinha123', '2024-12-01', '17:00:00', 1);


INSERT INTO USUARIOS(ID_USUARIOS, CPF, NOME, TELEFONE, LOGIN_ID_USUARIOS, ENDERECOS_ID_USUARIOS) VALUES
(1, '111.111.111-01', 'ROBERTO DA SILVA', '(27)91111-1111', 2, 2),
(2, '222.222.222-02', 'MARIA SOUZA', '(27)92222-2222', 3, 3),
(3, '333.333.333-03', 'CARLA MENDES', '(27)93333-3333', 4, 4),
(4, '444.444.444-04', 'JOÃO FERREIRA', '(27)94444-4444', 5, 5);

INSERT INTO FALE_CONOSCO(ID_FC, RECLAMACAO, DATA_RECLAMACAO, USUARIOS_ID_FC) VALUES
(1, 'Enviei todos os documentos, sigo aguardando o retorno', '2024-11-30', 1);

INSERT INTO PROJETOS(ID_PROJETO, NOME_PROJETO, EMPRESAS_ID_PROJETO, FINANCEIRO_ID_PROJETO) VALUES
(1, 'TECNOLOGIA NAS ESCOLAS', 1, 1),
(2, 'ALIMENTAÇÃO PARA COMUNIDADES CARENTES', 2, 2);

INSERT INTO HISTORICO_ACOMPANHAMENTO(DATA_HISTORICO, PROJETOS_ID_HISTORICO, STATUS_PROJETO, FUNCIONARIOS_ID_HA) VALUES
('2024-11-30', 1, 'PENDENTE', 1),
('2024-12-01', 2, 'PENDENTE', 1);


INSERT INTO USUARIOS_PROJETOS(PROJETOS_ID, USUARIOS_ID) VALUES
(2, 1),
(2, 2),
(1, 3),
(2, 4);
